"use strict";(self.webpackChunkn2_utility=self.webpackChunkn2_utility||[]).push([[51820],{15671:(t,e,n)=>{n.d(e,{A:()=>i});class i{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.x=t,this.y=e,this.width=n,this.height=i}get isEmpty(){return this.width<=0||this.height<=0}union(t){this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.width=Math.max(this.width,t.width),this.height=Math.max(this.height,t.height)}}},19358:(t,e,n)=>{n.d(e,{A:()=>s});var i=n(59422);class s{constructor(t,e,n,s){this.transformedX=0,this.transformedY=0,this.center=(0,i.fA)(t,e),this.centerT=(0,i.vt)(),this.halfWidth=n/2,this.halfHeight=s/2,this.width=n,this.height=s}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(t){this.center[0]=t}set y(t){this.center[1]=t}clone(){return new s(this.x,this.y,this.width,this.height)}serialize(t){return t.writeF32(this.center[0]),t.writeF32(this.center[1]),t.push(this.width),t.push(this.height),t}findCollisionDelta(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;const n=Math.abs(t.centerT[0]-this.centerT[0]),i=Math.abs(t.centerT[1]-this.centerT[1]),s=(t.halfWidth+this.halfWidth+e)/n,a=(t.halfHeight+this.halfHeight+e)/i,r=Math.min(s,a);return Math.log2(r)}extend(t){const e=Math.min(this.xmin,t.xmin),n=Math.min(this.ymin,t.ymin),i=Math.max(this.xmax,t.xmax)-e,s=Math.max(this.ymax,t.ymax)-n,a=e+i/2,r=n+s/2;this.width=i,this.height=s,this.halfWidth=i/2,this.halfHeight=s/2,this.x=a,this.y=r}static deserialize(t){const e=t.readF32(),n=t.readF32(),i=t.readInt32(),a=t.readInt32();return new s(e,n,i,a)}}},37119:(t,e,n)=>{n.d(e,{Hg:()=>c,Rl:()=>u,ik:()=>h,yb:()=>l});var i=n(95114),s=n(57491),a=n(28731),r=n(99433),o=n(86659);function l(t,e){const n=e.featureReduction;if("fields"in n)for(const i of n.fields)if(i.name.toLowerCase()===t.toLowerCase())return i;return null}function h(t){return`\n  $feature["${t}"];\n  var value = $feature["${t}"];\n  var num = Count(Text(Round(value)));\n  var label = When(\n    num < 4, Text(value, "#.#"),\n    num == 4, Text(value / Pow(10, 3), "#.0k"),\n    num <= 6, Text(value / Pow(10, 3), "#k"),\n    num == 7, Text(value / Pow(10, 6), "#.0m"),\n    num > 7, Text(value / Pow(10, 6), "#m"),\n    Text(value, "#,###")\n  );\n  return label;\n  `}function c(t,e,n,i){const s=n.name;if("mode"===n.statisticType){const o="getFieldDomain"in t?t.getFieldDomain(n.onStatisticField):null;let l=null;return"coded-value"===o?.type?l=o.codedValues.map((t=>new a.default({value:t.code,label:t.name}))):"unique-value"===e?.type&&null!=e.field&&e.field.toLowerCase()===s.toLowerCase()&&(l=(e.uniqueValueInfos??[]).map((t=>t.clone()))),l?(0,r.Wx)(l,s,i):`Text($feature["${s}"])`}return h(s)}function u(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=new o.default({haloColor:"#373837",haloSize:"1px",color:"#f0f0f0",font:{family:"Noto Sans",size:"12px",weight:"bold"}});return new i.default({symbol:n,deconflictionStrategy:"none",labelPlacement:e?"always-horizontal":"center-center",labelExpressionInfo:new s.A({expression:t})})}},40392:(t,e,n)=>{n.d(e,{Tl:()=>_});var i=n(94967),s=n(98006),a=n(19555),r=n(59422),o=n(71447),l=n(15671),h=n(19358);const c=4,u=22+c,f=3,d=Math.PI/180;class m{constructor(t,e,n,i){this._rotationT=(0,s.vt)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const a=n.rect,r=new Float32Array(8);t*=i,e*=i;const o=n.code?a.width*i:n.metrics.width,l=n.code?a.height*i:n.metrics.height;this.width=o,this.height=l,r[0]=t,r[1]=e,r[2]=t+o,r[3]=e,r[4]=t,r[5]=e+l,r[6]=t+o,r[7]=e+l,this._data=r,this._setTextureCoords(a),this._scale=i,this._mosaic=n,this.x=t,this.y=e,this.maxOffset=Math.max(t+o,e+l)}get mosaic(){return this._mosaic}set angle(t){this._angle=t,(0,i.$0)(this._rotationT,-t),this._setOffsets()}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:t,width:e}=this._mosaic.metrics,n=e*this._scale,a=Math.abs(t)*this._scale,r=new Float32Array(8);r[0]=this.x,r[1]=this.y,r[2]=this.x+n,r[3]=this.y,r[4]=this.x,r[5]=this.y+a,r[6]=this.x+n,r[7]=this.y+a;const o=(0,i.lw)((0,s.vt)(),this._rotationT,this._transform);(0,s.gb)(r,r,o);let l=1/0,c=1/0,u=-1/0,f=-1/0;for(let i=0;i<4;i++){const t=r[2*i],e=r[2*i+1];l=Math.min(l,t),c=Math.min(c,e),u=Math.max(u,t),f=Math.max(f,e)}const d=u-l,m=f-c,g=l+d/2,p=c+m/2;this._bounds=new h.A(g,p,d,m)}return this._bounds}setTransform(t){this._transform=t,this._offsets=null}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const t=(0,i.lw)((0,s.vt)(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],(0,a.l0)(this._offsets.topLeft,this._offsets.topLeft,t),(0,a.l0)(this._offsets.topRight,this._offsets.topRight,t),(0,a.l0)(this._offsets.bottomLeft,this._offsets.bottomLeft,t),(0,a.l0)(this._offsets.bottomRight,this._offsets.bottomRight,t)}_setTextureCoords(t){let{x:e,y:n,width:i,height:s}=t;this._texcoords={topLeft:[e,n],topRight:[e+i,n],bottomLeft:[e,n+s],bottomRight:[e+i,n+s]}}}const g=(t,e)=>({code:0,page:0,sdf:!0,rect:new l.A(0,0,11,8),textureBinding:e,metrics:{advance:0,height:4,width:t,left:0,top:0}});function p(t,e){return t.forEach((t=>(0,a.l0)(t,t,e))),{topLeft:t[0],topRight:t[1],bottomLeft:t[2],bottomRight:t[3]}}class x{constructor(t,e,n){this._rotation=0,this._decorate(t,e,n),this.glyphs=t,this.bounds=this._createBounds(t),this.isMultiline=e.length>1,this._hasRotation=0!==n.angle,this._transform=this._createGlyphTransform(this.bounds,n),this._borderLineSizePx=n.borderLineSizePx,(n.borderLineSizePx||n.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const i of t)i.setTransform(this._transform)}setRotation(t){if(0===t&&0===this._rotation)return;this._rotation=t;const e=this._transform,n=(0,i.$0)((0,s.vt)(),t);(0,i.lw)(e,n,e);for(const i of this.glyphs)i.setTransform(this._transform)}_decorate(t,e,n){if(!n.decoration||"none"===n.decoration||!t.length)return;const i=n.scale,s="underline"===n.decoration?u:16,a=t[0].textureBinding;for(const r of e){const e=r.startX*i,n=r.startY*i,o=(r.width+r.glyphWidthEnd)*i;t.push(new m(e,n+s*i,g(o,a),1))}}shapeBackground(t){const e=(1.5+(this._borderLineSizePx||0))/2,n=this._borderLineSizePx?e:0,{xmin:i,ymin:s,xmax:a,ymax:r,x:o,y:l,width:c,height:u}=this.bounds,f=[i-8,s-8],d=[a+8,s-8],m=[i-8,r+8],g=[a+8,r+8],x=p([[f[0]-e,f[1]-e],[d[0]+e,d[1]-e],[f[0]+n,f[1]+n],[d[0]-n,d[1]+n]],t),y=p([[m[0]+n,m[1]-n],[g[0]-n,g[1]-n],[m[0]-e,m[1]+e],[g[0]+e,g[1]+e]],t),b=p([[f[0]-e,f[1]-e],[f[0]+n,f[1]+n],[m[0]-e,m[1]+e],[m[0]+n,m[1]-n]],t),v=p([[d[0]-n,d[1]+n],[d[0]+e,d[1]-e],[g[0]-n,g[1]-n],[g[0]+e,g[1]+e]],t),w={main:p([f,d,m,g],t),top:x,bot:y,left:b,right:v};return[new h.A(o,l,c+2*e,u+2*e),w]}get boundsT(){const t=this.bounds,e=(0,a.hZ)((0,r.vt)(),t.x,t.y);if((0,a.l0)(e,e,this._transform),this._hasRotation){const n=Math.max(t.width,t.height);return new h.A(e[0],e[1],n,n)}return new h.A(e[0],e[1],t.width,t.height)}_createBounds(t){let e=1/0,n=1/0,i=0,s=0;for(const o of t)e=Math.min(e,o.xTopLeft),n=Math.min(n,o.yTopLeft),i=Math.max(i,o.xBottomRight),s=Math.max(s,o.yBottomRight);const a=i-e,r=s-n;return new h.A(e+a/2,n+r/2,a,r)}_createGlyphTransform(t,e){const n=d*e.angle,o=(0,s.vt)(),l=(0,r.vt)();return(0,i.Tl)(o,o,(0,a.hZ)(l,e.xOffset,-e.yOffset)),e.useCIMAngleBehavior?(0,i.e$)(o,o,n):((0,i.Tl)(o,o,(0,a.hZ)(l,t.x,t.y)),(0,i.e$)(o,o,n),(0,i.Tl)(o,o,(0,a.hZ)(l,-t.x,-t.y))),o}}class y{constructor(t,e,n,i,s,a){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(e,n)),this.end=Math.max(0,Math.max(e,n)),this.end<t.length&&(this.glyphWidthEnd=t[this.end].metrics.width),this.width=i,this.yMin=s,this.yMax=a}}const b=t=>10===t,v=t=>32===t;function w(t,e){let n=0;for(let a=0;a<t.length;a++){const{width:e}=t[a];n=Math.max(e,n)}const i="underline"===e.decoration?c:0,s=t[0].yMin;return{x:0,y:s,height:t[t.length-1].yMax+e.lineHeight*(t.length-1)+i-s,width:n}}function _(t,e){const n=e.scale,i=new Array,{glyphs:s,isRightToLeft:a}=t,r=function(t,e,n){const i=new Array,s=1/n.scale,a=n.maxLineWidth*s,r=e?t.length-1:0,o=e?-1:t.length,l=e?-1:1;let h=r,c=0,u=0,f=h,d=f,m=0,g=1/0,p=0;for(;h!==o;){const{code:e,metrics:n}=t[h],s=Math.abs(n.top);if(b(e)||v(e)||(g=Math.min(g,s),p=Math.max(p,s+n.height)),b(e))h!==r&&(i.push(new y(t,f,h-l,c,g===1/0?0:g,p)),g=1/0,p=0),c=0,f=h+l,d=h+l,u=0;else if(v(e))d=h+l,u=0,m=n.advance,c+=n.advance;else if(c>a){if(d!==f){const e=d-2*l;c-=m,i.push(new y(t,f,e,c-u,g,p)),g=1/0,p=0,f=d,c=u}else i.push(new y(t,f,h-l,c,g,p)),g=1/0,p=0,f=h,d=h,c=0;c+=n.advance,u+=n.advance}else c+=n.advance,u+=n.advance;h+=l}const x=new y(t,f,h-l,c,g,p);return x.start>=0&&x.end<t.length&&i.push(x),i}(s,a,e),l=r.length?w(r,e):{x:0,y:0,height:0,width:0},h=(0,o.xy)(e.horizontalAlignment),c=(0,o.UD)(e.verticalAlignment),u=c===o.gy.Baseline?1:0,d=u?0:c-1,g=(1-u)*-l.y+d*(l.height/2)+-22*(u?1:0);for(let o=0;o<r.length;o++){const{start:a,end:l,width:c}=r[o];let u=-1*(h+1)*(c/2)-f;const d=(t.isRightToLeft?r.length-1-o:o)*e.lineHeight+g-f;r[o].startX=u,r[o].startY=d;for(let t=a;t<=l;t++){const e=s[t];if(b(e.code))continue;const a=new m(u+e.metrics.left,d-e.metrics.top,e,n);u+=e.metrics.advance,i.push(a)}}return new x(i,r,e)}},51820:(t,e,n)=>{n.r(e),n.d(e,{getLabelSchemes:()=>x});var i=n(50076),s=n(63860),a=n(76931),r=n(5095),o=n(40392);async function l(t,e,n){const i={type:"cim-rasterization-info",resource:{type:"text",textString:t.text,font:t.font}},s=e.textureManager.rasterizeItem(i,n),l=await s;return(0,o.Tl)(l,{angle:t.angle??0,xOffset:(0,a.Lz)(t.xoffset??0),yOffset:(0,a.Lz)(t.yoffset??0),lineHeight:r.DY*Math.max(.25,t.lineHeight),maxLineWidth:Math.max(32,Math.min((0,a.Lz)(t.lineWidth),512)),decoration:t.font.decoration,scale:Math.min(Math.round((0,a.Lz)(t.font.size)),127)/r.eG,horizontalAlignment:"center",verticalAlignment:"middle",useCIMAngleBehavior:!1,hasBackground:!!t.backgroundColor,borderLineSizePx:(0,a.Lz)(t.borderLineSize)}).boundsT}let h=l;async function c(t,e,n){return h(t,e.stage,n)}async function u(t,e){await e.when();const n=t.clone();n.text="999";const i=await c(n,e);return(0,a.PN)(i.width)}var f=n(37119),d=n(99433),m=n(40700);async function g(t){const{layer:e,renderer:n,view:s}=t;await Promise.all([e.load(),s.when()]);const a=n||e.renderer;if(!(0,m.k)(a))throw new i.default("clusters-label-schemes:invalid-parameters","'renderer' is not valid");return{layer:e,renderer:a,view:s}}async function p(t){const{renderer:e,view:n,statInfo:i}=t,s=i?.statisticType,a=i?(0,d.Dv)(i.attributeInfo,s):d.Qb,r="type"===s?function(t,e,n){const i="unique-value"===t.type?t.uniqueValueInfos??[]:[];return(0,d.Wx)(i,e,n)}(e,a,t.noneValueLabel):(0,f.ik)(a),o=(0,f.Rl)(r);return{name:i?`clusters-${s}-${(0,d.pq)(a,s)}`:"clusters-count",labelingInfo:[o],clusterMinSize:await u(o.symbol,n),fieldName:a}}async function x(t){const[{renderer:e,layer:n,view:a},r]=await Promise.all([g(t),(0,s.ud)("esri/smartMapping/t9n/smartMapping")]),o=r.clusters.predominantNoneValue;if(!e)return null;let l=null;const h=[];if(t.field){const s=(0,f.yb)(t.field,n);if(!s)throw new i.default("clusters-label-schemes:invalid-parameters","'field' is not a valid aggregate field");const{name:r}=s,c=(0,f.Hg)(n,e,s,o),d=(0,f.Rl)(c);return l={name:`clusters-${r}`,labelingInfo:[d],clusterMinSize:await u(d.symbol,a),fieldName:r},{primaryScheme:l,secondarySchemes:h}}const c=function(t){const e=new Map;for(const n of t)"size"===n.attributeInfo.vvType?e.set(n.statisticHash,n):e.has(n.statisticHash)||e.set(n.statisticHash,n);return[...e.values()]}((0,d.eU)(n,e,!1));for(const i of c){const t=await p({renderer:e,view:a,statInfo:i,noneValueLabel:o});"size"===i.attributeInfo.vvType?l=t:h.push(t)}const m=await p({renderer:e,view:a});return l?h.unshift(m):l=m,{primaryScheme:l,secondarySchemes:h}}},71447:(t,e,n)=>{n.d(e,{Dy:()=>f,UD:()=>h,fO:()=>c,gy:()=>r,iT:()=>u,xy:()=>l});var i=n(76460);const s=()=>i.A.getLogger("esri.views.2d.engine.webgl.alignmentUtils");var a,r,o;function l(t){if(!t)return a.Center;switch(t){case"Left":case"left":return a.Left;case"Right":case"right":return a.Right;case"Justify":return s().warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),a.Center;case"Center":case"center":return a.Center}}function h(t){if(!t)return r.Center;switch(t){case"Top":case"top":return r.Top;case"Center":case"middle":return r.Center;case"Baseline":case"baseline":return r.Baseline;case"Bottom":case"bottom":return r.Bottom}}function c(t){switch(t){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return["right","bottom"];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return["center","bottom"];case"above-right":case"esriServerPointLabelPlacementAboveRight":return["left","bottom"];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return["right","middle"];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return["center","middle"];case"center-right":case"esriServerPointLabelPlacementCenterRight":return["left","middle"];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return["right","top"];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return["center","top"];case"below-right":case"esriServerPointLabelPlacementBelowRight":return["left","top"];default:return console.debug(`Found invalid placement type ${t}`),["center","middle"]}}function u(t){switch(t){case a.Right:case"right":return-1;case a.Center:case"center":return 0;case a.Left:case"left":return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}}function f(t){switch(t){case r.Top:case"top":return 1;case r.Center:case"middle":return 0;case r.Bottom:case r.Baseline:case"baseline":case"bottom":return-1;default:return console.debug(`Found invalid vertical alignment ${t}`),0}}(o=a||(a={}))[o.Left=-1]="Left",o[o.Center=0]="Center",o[o.Right=1]="Right",function(t){t[t.Top=1]="Top",t[t.Center=0]="Center",t[t.Bottom=-1]="Bottom",t[t.Baseline=2]="Baseline"}(r||(r={}))},97336:(t,e,n)=>{n.d(e,{G2:()=>x,Lb:()=>T,Xj:()=>_,bF:()=>p,gS:()=>L,lm:()=>b});var i=n(18690),s=(n(81806),n(63860)),a=n(39348),r=n(53430),o=(n(75900),n(56362),n(87015),n(81940),n(6929)),l=(n(7198),n(93616),n(53539)),h=(n(91904),n(81779)),c=n(40585),u=n(17542),f=n(23994),d=n(15492),m=n(90704);let g=0;const p="expression/";function x(t){return"hasVisualVariables"in t&&t.hasVisualVariables()?t.visualVariables.filter((t=>!d.viewScaleRE.test(t.valueExpression)&&(!("target"in t)||"outline"!==t.target))):[]}function y(t,e){if(!e)return null;const n=(0,m.Rm)(t);return n?.find((t=>t.name.toLowerCase()===e.toLowerCase()))}function b(t,e,n){let i=null;if(n&&"featureReduction"in t){const e=t.featureReduction;e&&"popupTemplate"in e&&e.popupTemplate&&(i=e.popupTemplate.fieldInfos)}else"popupTemplate"in t&&t.popupTemplate&&(i=t.popupTemplate.fieldInfos);const s=n?y(t,e):t.getField(e);let a=null;if(i&&i.some((t=>!(!t||t.fieldName?.toLowerCase()!==s?.name.toLowerCase())&&(a=t.clone(),!0))),!a){const t=r.numericTypes.includes(s.type),e="integer"===s.type||"small-integer"===s.type;a=new c.default({fieldName:s.name,isEditable:s.editable,visible:!0,format:t?new u.default({places:e?0:2,digitSeparator:!0}):void 0})}return a.label||(a.label=s.alias),a}function v(t){const{expression:e,title:n,returnType:i}=t;return new h.default({name:"expr"+g++,expression:e,title:n,returnType:i})}function w(t){const e="number"===t.returnType?new u.default({places:2,digitSeparator:!0}):void 0;return new c.default({fieldName:`${p}${t.name}`,visible:!0,format:e})}async function _(t){const e=await(0,s.ud)("esri/smartMapping/t9n/smartMapping"),{renderer:n,layer:r,normFieldExpressionTemplate:o,isFeatureReduction:l}=t,h=[],c=[],u=(0,f.getAttributes)(n,x);for(const i of u)if("field"===i.type)h.push(b(r,i.field,l));else if("normalized-field"===i.type){const t=l?y(r,i.field):r.getField(i.field),n=l?y(r,i.normalizationField):r.getField(i.normalizationField),s=v({type:"expression",expression:`\n      $feature["${t.name}"];\n      $feature["${n.name}"];\n      ${"percentage"===o?`($feature["${t.name}"] / $feature["${n.name}"]) * 100;`:`$feature["${t.name}"] / $feature["${n.name}"];`}\n      `,title:(0,a.V)("percentage"===o?e.normFieldLabelAsPercent:e.normFieldLabel,{expression1:t.alias,expression2:n.alias}),returnType:"number"});h.push(w(s),b(r,i.field,l),b(r,i.normalizationField,l)),c.push(s)}else if("expression"===i.type){const t=v(i);h.push(w(t)),c.push(t)}return{fieldInfos:(0,i.Am)(h,((t,e)=>t.fieldName===e.fieldName)),expressionInfos:(0,i.Am)(c,((t,e)=>t.expression===e.expression))}}async function T(t,e,n){const{fieldInfos:i,expressionInfos:r}=e,h=await(0,s.ud)("esri/smartMapping/t9n/smartMapping");if(i.length>2)return[new o.default({fieldInfos:i})];const c=[];for(const s of i){const e=s.fieldName||"";let i=s.label;if(!i){const s=n?y(t,e):t.getField(e);if(s)i=s.alias||e;else if(r){const t=e.split(p)[1],n=r[r.findIndex((e=>e.name===t))];n&&(i=n.title||n.name)}}c.push(new l.default({text:(0,a.V)(h.fieldInfo,{fieldLabel:i,fieldValue:`{${e}}`})}))}return c}function L(t){return!(!("normalizationField"in t)||!t.normalizationField)||"hasVisualVariables"in t&&t.hasVisualVariables()&&t.visualVariables.some((t=>!(!("normalizationField"in t)||!t.normalizationField)))}},99433:(t,e,n)=>{n.d(e,{Dv:()=>u,Qb:()=>l,Wx:()=>g,eU:()=>y,pq:()=>h});var i=n(18690),s=n(53514),a=n(4815),r=n(97336),o=n(42633);const l="cluster_count";function h(t,e){return t.split(`cluster_${e}_`).pop()}function c(t,e){const n=function(t){if(!t)return null;const{field:e,valueExpression:n,normalizationField:i,normalizationType:s,normalizationTotal:r}=t;let l=null;if(n)l=n;else if(e){const t=(0,o.Wy)({normalizationType:s,normalizationField:i,normalizationTotal:r});if(t){const n=t.toLowerCase();if(l=e.toLowerCase()+",norm:"+n,i)l+=","+i.toLowerCase();else if("percent-of-total"===n){let t=r;(0,a.gf)(t)&&0!==t||(t=null),l+=","+t}}}return l}(t);return`${e}_${null!=n?function(t){return(0,s.d)(t)}(n):t.field}`}function u(t,e){return`cluster_${c(t,e)}`}function f(t,e){const n=e.getField(t);return n?.type}function d(t,e){const n="rotation"===e.type?e.rotationType:null,i=e.legendOptions?.title,s=e.field,a=s?f(s,t):null;return{field:s,fieldType:null!=a?a:null,rotationType:n,valueExpression:e.valueExpression,valueExpressionTitle:e.valueExpressionTitle||e.valueExpression&&i,normalizationField:"normalizationField"in e?e.normalizationField:null,vvType:e.type}}function m(t){return t?t.replaceAll('"','\\"'):""}function g(t,e,n){return`\n  var uvInfos = [${function(t){return t.map((t=>`{\n        "value": "${String(t.value)}",\n        "label": "${m(String(t.label))}"\n      }`))}(t).join(", ")}];\n  var predominantType = Text($feature["${e}"]);\n  var label = "${m(n)}";\n\n  for (var i = 0; i < Count(uvInfos); i++) {\n    if (uvInfos[i].value == predominantType) {\n      label = uvInfos[i].label;\n      break;\n    }\n  }\n\n  return label;\n  `}function p(t,e){const n=[c(t,e)];return"date"===t.fieldType&&n.push(t.fieldType.toLowerCase()),t.rotationType&&n.push(t.rotationType.toLowerCase()),n.join("_")}function x(t,e){return{statisticHash:p(t,e),attributeInfo:t,statisticType:e}}function y(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=[],a=function(t,e){const n="field"in e?e.field:null,i=n?f(n,t):null;return{field:n,fieldType:null!=i?i:null,valueExpression:"valueExpression"in e?e.valueExpression:null,valueExpressionTitle:"valueExpressionTitle"in e?e.valueExpressionTitle:null,normalizationField:"normalizationField"in e?e.normalizationField:null,normalizationType:"normalizationType"in e?e.normalizationType:null,normalizationTotal:"normalizationTotal"in e?e.normalizationTotal:null}}(t,e);"class-breaks"===e.type?s.push(x(a,"avg")):"unique-value"===e.type&&s.push(x(a,"type"));const o=(0,r.G2)(e);for(const i of o){const e=d(t,i);s.push(x(e,"avg"))}return n?(0,i.Am)(s,((t,e)=>t.statisticHash===e.statisticHash)):s}}}]);
//# sourceMappingURL=51820.59749f57.chunk.js.map