"use strict";(self.webpackChunkn2_utility=self.webpackChunkn2_utility||[]).push([[11371,62315,68479],{11371:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var i=s(35143),n=s(68479),l=s(19276),a=s(46053),r=(s(81806),s(76460),s(47249),s(85842)),o=s(29078);const h=new Set;let c=class extends o.D{constructor(e){super(e),this.analysis=null,this.supportedViewType="3d",this.unsupportedErrorMessage="SliceViewModel is only supported in 3D views.",h.add(this)}destroy(){h.delete(this)}get state(){return this.disabled||!this.ready?"disabled":null==this.tool?"ready":this.tool.state}get shape(){return this.analysis.shape}set shape(e){this.analysis.shape=e}get tiltEnabled(){return this.analysis.tiltEnabled}set tiltEnabled(e){this.analysis.tiltEnabled=e}get layersMode(){return this.tool?.layersMode??"none"}get excludedLayers(){return this.analysis.excludedLayers}set excludedLayers(e){this.analysis.excludedLayers=l.default.isCollection(e)?e:new l.default(e)}get excludeGroundSurface(){return this.analysis.excludeGroundSurface}set excludeGroundSurface(e){this.analysis.excludeGroundSurface=e}async start(){await super.start(),h.forEach((e=>{e.view===this.view&&e!==this&&e.clear()})),null!=this.analysisView&&(this.analysisView.active=!0)}enterExcludeLayerMode(){null!=this.tool&&this.tool.enterExcludeLayerMode()}exitExcludeLayerMode(){null!=this.tool&&this.tool.exitExcludeLayerMode()}onConnectToAnalysisView(e){e.active=!0}constructAnalysis(){return new n.default}};(0,i._)([(0,a.MZ)({type:n.default})],c.prototype,"analysis",void 0),(0,i._)([(0,a.MZ)({readOnly:!0})],c.prototype,"state",null),(0,i._)([(0,a.MZ)()],c.prototype,"shape",null),(0,i._)([(0,a.MZ)()],c.prototype,"tiltEnabled",null),(0,i._)([(0,a.MZ)()],c.prototype,"layersMode",null),(0,i._)([(0,a.MZ)()],c.prototype,"excludedLayers",null),(0,i._)([(0,a.MZ)({nonNullable:!0})],c.prototype,"excludeGroundSurface",null),c=(0,i._)([(0,r.$)("esri.widgets.Slice.SliceViewModel")],c);const u=c},29078:(e,t,s)=>{s.d(t,{D:()=>p});var i,n,l=s(35143),a=s(91967),r=s(98773),o=(s(81806),s(76460)),h=s(30726),c=s(50346),u=s(68134),d=s(46053),y=(s(47249),s(85842));(n=i||(i={}))[n.PENDING=0]="PENDING",n[n.WAIT_FOR_VIEW_READY=1]="WAIT_FOR_VIEW_READY",n[n.RUNNING=2]="RUNNING";let p=class extends a.default{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(e),this.view=null,this.analysisView=null,this._reconnectViewTask=null,this._forceInteractiveHandle=null,this._parentChangeFromReconnect=!1,this._startUserOperation=null;const t=e?.analysis;null!=t?this.analysis=t:(this._set("analysis",this.constructAnalysis()),this._set("isAnalysisOwner",!0)),null!=e?.visible&&(this.visible=e.visible)}normalizeCtorArgs(e){const{analysis:t,...s}=e;return s}initialize(){this.addHandles([(0,u.watch)((()=>({readyAndNotSupported:null!=this.view&&this.view.ready&&!this.supported})),(e=>{let{readyAndNotSupported:t}=e;t&&o.A.getLogger(this).errorOnce(this.unsupportedErrorMessage)}),u.syncAndInitial),(0,u.watch)((()=>this.analysis?.parent),(e=>{this._parentChangeFromReconnect||e===this.view||this._set("isAnalysisOwner",!1);const t=!this._parentChangeFromReconnect;this._parentChangeFromReconnect=!1,t&&this._scheduleViewReconnect()}),u.sync),(0,u.watch)((()=>({view:this.view,ready:null!=this.view&&this.view.ready,supported:this.supported})),((e,t)=>{let{view:s}=e;const i=t?.view;s!==i&&(this._startUserOperation=(0,h.DC)(this._startUserOperation),this._disconnectFromView(i)),this._scheduleViewReconnect()}),u.syncAndInitial)])}destroy(){this._reconnectViewTask=(0,h.DC)(this._reconnectViewTask),this._startUserOperation=(0,h.DC)(this._startUserOperation),null!=this.analysisView&&(this.analysisView.visible=void 0),this._disconnectFromView(this.view),this._set("view",null),null!=this.analysis&&this.isAnalysisOwner&&(this.analysis.destroy(),this._set("analysis",null))}get supported(){return null==this.view||this.view.type===this.supportedViewType}set visible(e){this._set("visible",e),null!=this.analysisView&&(this.analysisView.visible=e)}get active(){return null!=this.tool&&this.tool.active}get disabled(){return null==this.view||!this.view.ready||!this.supported}set analysis(e){e!==this._get("analysis")&&(this._startUserOperation=(0,h.DC)(this._startUserOperation),this._disconnectFromView(this.view),this._setExternalAnalysis(e),this._scheduleViewReconnect())}get ready(){return null!=this.analysisView&&!this.connectingToView}get connectingToView(){return null!=this._reconnectViewTask}get isAnalysisOwner(){return this._get("isAnalysisOwner")}get tool(){return null!=this.analysisView?this.analysisView.tool:null}clear(){this._startUserOperation=(0,h.DC)(this._startUserOperation),this._resetInteractiveCreationState(),null!=this.tool&&null!=this.view&&this.view.activeTool===this.tool&&(this.view.activeTool=null)}async start(){if(!this.visible)return void o.A.getLogger(this).warn("Cannot start analysis when not visible");this.clear();const e={task:null,abort:null,state:i.PENDING},t=(0,r.UT)((async t=>{if(e.state=i.WAIT_FOR_VIEW_READY,await(0,u.whenOnce)((()=>this.ready),t),e.state=i.RUNNING,null==this.analysisView||null==this.view)return;const s=this.analysisView.tool;null!=s&&(this.view.activeTool=s,(0,u.when)((()=>s.created),(()=>{s.active&&null!=this.view&&(this.view.activeTool=null)}),{initial:!0,once:!0}))}));return e.task=t,e.abort=()=>t.abort(),this._startUserOperation=e,t.promise}onConnectToAnalysisView(e){}onDisconnectFromAnalysisView(){}_scheduleViewReconnect(){this._reconnectViewTask=(0,h.DC)(this._reconnectViewTask);const e=(0,r.UT)((async t=>{try{await this._reconnectView(t)}catch(s){if((0,c.throwIfAborted)(t),!(0,c.isAbortError)(s))return void o.A.getLogger(this).warn("Failed to use analysis in view model",s);throw s}finally{e===this._reconnectViewTask&&(this._reconnectViewTask=null)}}));this._reconnectViewTask=e}async _reconnectView(e){const{view:t}=this,s=null!=t&&t.ready&&this.supported,i=this.analysis;if(this._startUserOperation=w(this._startUserOperation),this._disconnectFromView(t),s&&null!=t&&null!=i){if(this.isAnalysisOwner){if(null!=i.parent)return void o.A.getLogger(this).errorOnce("expected owned analysis to have null parent when connecting to view");this._parentChangeFromReconnect=!0,t.analyses.add(i)}this.analysisView=await t.whenAnalysisView(i),(0,c.isAborted)(e)?this._startUserOperation=w(this._startUserOperation):(this.analysisView.visible=this.visible,this._forceInteractiveHandle=this.analysisView.forceInteractiveForViewModel(),this.addHandles(this._forceInteractiveHandle),this.onConnectToAnalysisView(this.analysisView))}}_disconnectFromView(e){null!=e&&this.isAnalysisOwner&&e.analyses.includes(this.analysis)&&(this._parentChangeFromReconnect=!0,this.analysis.clear(),e.analyses.remove(this.analysis)),this.onDisconnectFromAnalysisView(),this._forceInteractiveHandle=(0,h.xt)(this._forceInteractiveHandle),this.analysisView=null}_setExternalAnalysis(e){null==this.analysisView||this.isAnalysisOwner||(this.analysisView.visible=void 0,this._forceInteractiveHandle=(0,h.xt)(this._forceInteractiveHandle)),this.analysisView=null,this._set("isAnalysisOwner",!1),this._set("analysis",e),this._parentChangeFromReconnect=!1}_resetInteractiveCreationState(){this.analysis.clear(),null!=this.tool&&this.tool.resetCreated()}get testInfo(){}};function w(e){return null!=e&&e.state>=i.RUNNING?(e.abort(),null):e}(0,l._)([(0,d.MZ)()],p.prototype,"supported",null),(0,l._)([(0,d.MZ)()],p.prototype,"view",void 0),(0,l._)([(0,d.MZ)({type:Boolean,value:!0})],p.prototype,"visible",null),(0,l._)([(0,d.MZ)()],p.prototype,"active",null),(0,l._)([(0,d.MZ)()],p.prototype,"disabled",null),(0,l._)([(0,d.MZ)({nonNullable:!0})],p.prototype,"analysis",null),(0,l._)([(0,d.MZ)()],p.prototype,"analysisView",void 0),(0,l._)([(0,d.MZ)()],p.prototype,"ready",null),(0,l._)([(0,d.MZ)()],p.prototype,"connectingToView",null),(0,l._)([(0,d.MZ)({readOnly:!0})],p.prototype,"isAnalysisOwner",null),(0,l._)([(0,d.MZ)()],p.prototype,"_reconnectViewTask",void 0),(0,l._)([(0,d.MZ)()],p.prototype,"_forceInteractiveHandle",void 0),(0,l._)([(0,d.MZ)()],p.prototype,"tool",null),p=(0,l._)([(0,y.$)("esri.widgets.support.AnalysisViewModel")],p)},62315:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var i=s(35143),n=s(69098),l=s(73582),a=s(42553),r=s(30726),o=s(46053),h=s(21403),c=(s(81806),s(47249),s(85842)),u=s(40565),d=s(37546),y=s(19247);let p=class extends(n.A.ClonableMixin(a.A)){constructor(e){super(e),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(e){return this.heading===e.heading&&this.tilt===e.tilt&&(0,r.CM)(this.position,e.position)&&this.width===e.width&&this.height===e.height}};(0,i._)([(0,o.MZ)({readOnly:!0,json:{read:!1,write:!0}})],p.prototype,"type",void 0),(0,i._)([(0,o.MZ)({type:y.default}),(0,d.P)()],p.prototype,"position",void 0),(0,i._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,d.P)(),(0,h.w)((e=>l.ie.normalize((0,u.GB)(e),0,!0)))],p.prototype,"heading",void 0),(0,i._)([(0,o.MZ)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,d.P)(),(0,h.w)((e=>l.ie.normalize((0,u.GB)(e),0,!0)))],p.prototype,"tilt",void 0),(0,i._)([(0,o.MZ)({type:Number,nonNullable:!0}),(0,d.P)()],p.prototype,"width",void 0),(0,i._)([(0,o.MZ)({type:Number,nonNullable:!0}),(0,d.P)()],p.prototype,"height",void 0),p=(0,i._)([(0,c.$)("esri.analysis.SlicePlane")],p);const w=p},68479:(e,t,s)=>{s.r(t),s.d(t,{default:()=>u});var i=s(35143),n=s(95085),l=s(62315),a=s(19276),r=s(3975),o=s(46053),h=(s(81806),s(76460),s(47249),s(85842));let c=class extends n.A{constructor(e){super(e),this.type="slice",this.tiltEnabled=!1,this.shape=null,this.excludeGroundSurface=!1}get excludedLayers(){return this._get("excludedLayers")||new a.default}set excludedLayers(e){this._set("excludedLayers",(0,r.V)(e,this._get("excludedLayers")))}get requiredPropertiesForEditing(){return[this.shape?.position]}clear(){this.shape=null}};(0,i._)([(0,o.MZ)({type:["slice"]})],c.prototype,"type",void 0),(0,i._)([(0,o.MZ)()],c.prototype,"tiltEnabled",void 0),(0,i._)([(0,o.MZ)({types:{key:"type",base:null,typeMap:{plane:l.default},defaultKeyValue:"plane"}})],c.prototype,"shape",void 0),(0,i._)([(0,o.MZ)({cast:r.H,clonable:e=>e.slice()})],c.prototype,"excludedLayers",null),(0,i._)([(0,o.MZ)({type:Boolean,nonNullable:!0})],c.prototype,"excludeGroundSurface",void 0),(0,i._)([(0,o.MZ)({readOnly:!0})],c.prototype,"requiredPropertiesForEditing",null),c=(0,i._)([(0,h.$)("esri.analysis.SliceAnalysis")],c);const u=c}}]);
//# sourceMappingURL=11371.ee810806.chunk.js.map